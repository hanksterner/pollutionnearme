<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pollution Near Me ‚Äî Environmental Data & Accountability</title>
  <meta name="description"
    content="Track toxic sites, violations, and environmental risks in your community with transparent, data-driven reporting.">
  <meta property="og:title" content="Pollution Near Me ‚Äî Environmental Data & Accountability">
  <meta property="og:description" content="Transparent, data-driven reporting on pollution and environmental risks.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://pollutionnearme.org/">
  <meta property="og:image" content="/assets/og-image.png">
  <link rel="stylesheet" href="css/style.css">

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

  <style>
    #map {
      height: 600px;
      width: 100%;
    }
  </style>

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-XXXXXXXXXX');
  </script>
</head>

<body>
  <header>
    <h1>Pollution Near Me</h1>
    <p class="tagline">Transparent environmental data, updated continuously.</p>

    <!-- Hamburger menu in top-left corner -->
    <button class="hamburger" onclick="toggleMenu()">‚ò∞</button>
    <nav id="nav" class="hidden">
      <a href="/">Home</a>
      <a href="/about.html">About</a>
    </nav>

    <!-- Gray banner with centered search -->
    <div class="banner">
      <div id="search">
        <input type="text" id="location-search" placeholder="Enter ZIP, city, address, or business">
        <button onclick="searchLocation()">Search</button>
      </div>
    </div>
  </header>

  <main>
    <!-- Hero Section -->
    <section id="hero">
      <div id="map"></div>
      <div id="snapshot-card">
        <h2>Top Offenders Snapshot</h2>
        <p>Air Quality: Moderate ‚ö†Ô∏è</p>
        <p>Pollution Releases: 25,056 lbs</p>
        <p>Violations: 10 ($455k penalties)</p>
        <p>Superfund Sites: 2 nearby</p>
      </div>
    </section>

    <!-- Snapshot Tiles -->
    <section id="tiles">
      <div class="tile">üå§ <strong>Air Quality Today</strong><br>AQI: Moderate ‚ö†Ô∏è</div>
      <div class="tile">üè≠ <strong>Pollution Releases</strong><br>25,056 lbs ‚âà school bus</div>
      <div class="tile">‚öñÔ∏è <strong>Violations & Penalties</strong><br>10 violations, $455k ‚âà apartment building</div>
      <div class="tile">üß™ <strong>Superfund Sites</strong><br>2 sites nearby</div>
    </section>

    <!-- Ad Block -->
    <section id="ads">
      <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-xxxxxxxxxxxxxxxx" data-ad-slot="1234567890"
        data-ad-format="auto" data-full-width-responsive="true"></ins>
      <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
    </section>
  </main>

  <footer>
    &copy; 2025 Pollution Near Me. Data sources: EPA & environmental agencies.
    <a href="/terms.html">Terms of Service</a> | <a href="/privacy.html">Privacy Statement</a>
  </footer>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

  <script src="js/app.js"></script>
  <script>
    function searchLocation() {
      const query = document.getElementById('location-search').value;
      // TODO: implement geocoding + map re-center
      alert("Search for: " + query);
    }

    function toggleMenu() {
      const nav = document.getElementById('nav');
      nav.classList.toggle('hidden');
    }

    // Initialize Leaflet map
    async function initMap() {
      const map = L.map('map').setView([40.9, -77.7], 7); // Center on PA

      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '¬© OpenStreetMap contributors'
      }).addTo(map);

      const data = await fetch('data/tri.json').then(r => r.json());

      data.forEach(fac => {
        if (!fac.latitude || !fac.longitude) return;

        const marker = L.circleMarker([fac.latitude, fac.longitude], {
          radius: Math.max(3, Math.log(fac.release_lbs + 1)),
          color: fac.release_lbs > 1000 ? 'red' : fac.release_lbs > 100 ? 'orange' : 'green',
          fillOpacity: 0.6
        }).addTo(map);

        marker.bindPopup(`
          <strong>${fac.facility}</strong><br/>
          ${fac.chemical}<br/>
          ${fac.release_lbs} lbs released<br/>
          ${fac.city}, ${fac.county}
        `);
      });
    }

    initMap();
  </script>
</body>

</html>
